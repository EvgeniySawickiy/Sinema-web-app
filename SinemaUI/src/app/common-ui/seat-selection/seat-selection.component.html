<div class="seat-selection-overlay" *ngIf="isOpen">
  <div class="seat-selection-modal">
    <!-- Информация о фильме -->
    <div class="movie-info">
      <h2>{{ session.movieTitle }}</h2>
      <p class="genres">{{ session.movieGenres?.join(', ') || 'Не указан' }}</p>
      <p class="age-rating">Возраст: 12+</p>
    </div>

    <!-- Дата и время -->
    <div class="session-info">
      <p><strong>Дата:</strong> {{ session.startTime | date: 'dd MMMM yyyy' }}</p>
      <p><strong>Время:</strong> {{ session.startTime | date: 'HH:mm' }}</p>
      <p><strong>Кинозал:</strong> {{ session.hallName }}</p>
      <p><strong>Цена билета:</strong> {{ session.ticketPrice }} руб.</p>
    </div>

    <!-- Всплывающая подсказка -->
    <div class="seat-tooltip" *ngIf="hoveredSeat" [style.top.px]="tooltipY" [style.left.px]="tooltipX">
      Ряд {{ hoveredSeat.row }}, Место {{ hoveredSeat.number }}
    </div>

    <!-- Схема зала -->
    <div class="seat-map" *ngIf="seatRows.length > 0">
      <div class="screen">Экран</div>

      <div class="seats">
        <div *ngFor="let row of seatRows; let rowIndex = index" class="seat-row">
          <span class="row-label">{{ rowIndex + 1 }}</span>

          <div *ngFor="let seat of row"
               class="seat"
               [ngClass]="{
             'reserved': seat.isReserved,
             'selected': isSelected(seat),
             'available': !seat.isReserved
           }"
               (click)="toggleSeatSelection(seat)"
               (mouseenter)="showSeatInfo(seat, $event)"
               (mouseleave)="hideSeatInfo()"
               [style.cursor]="seat.isReserved ? 'not-allowed' : 'pointer'">
          </div>

          <span class="row-label">{{ rowIndex + 1 }}</span>
        </div>
      </div>
    </div>


    <!-- Выбранные места -->
    <div class="selected-seats" *ngIf="selectedSeats.length > 0">
      <h3>Выбранные места:</h3>
      <p *ngFor="let seatInfo of getFormattedSelectedSeats()">
        {{ seatInfo }}
      </p>
      <p><strong>Общая стоимость:</strong> {{ getTotalPrice() }} руб.</p>
    </div>

      <p class="max-seats-message" *ngIf="selectedSeats.length >= 5">
        Выбрано максимальное количество мест (5). Снимите одно, чтобы выбрать другое.
      </p>

    <!-- Легенда -->
    <div class="seat-legend">
      <span class="seat available"></span> Свободно
      <span class="seat reserved"></span> Занято
      <span class="seat selected"></span> Ваш выбор
    </div>

    <!-- Кнопки -->
    <div class="action-buttons">
      <button class="confirm-btn" (click)="confirmSelection()" [disabled]="selectedSeats.length === 0 || selectedSeats.length > 5">
        <span *ngIf="!isBooking">Подтвердить ({{ getTotalPrice() }} руб.)</span>
        <span *ngIf="isBooking">⏳ Бронирование...</span>
      </button>
      <button class="close-btn" (click)="onClose()">Отмена</button>
    </div>
  </div>
</div>
